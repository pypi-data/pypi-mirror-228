"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{52427:function(n,e,t){t.d(e,{a:function(){return s}});var r=t(73235),o=t(40794),i=t(60138);function u(){var n=(0,r._)(["\n  query InstanceSupportsCapturedLogs {\n    instance {\n      id\n      hasCapturedLogManager\n    }\n  }\n"]);return u=function(){return n},n}var s=function(){var n=(0,o.a)(c).data;return!!(null==n?void 0:n.instance.hasCapturedLogManager)},c=(0,i.Ps)(u())},3553:function(n,e,t){t.d(e,{h:function(){return C}});var r=t(85333),o=t(6692),i=t(2281),u=t(58467),s=t(73235),c=t(52322),a=t(26736),l=t(60138),d=t(40794),f=t(2736),p=t(87323),g=t(12734),h=t(2784),v=t(99200),m=t(38048),y=t(42130);function x(){var n=(0,s._)(["\n  subscription CapturedLogsSubscription($logKey: [String!]!, $cursor: String) {\n    capturedLogs(logKey: $logKey, cursor: $cursor) {\n      ...CapturedLog\n    }\n  }\n\n  fragment CapturedLog on CapturedLogs {\n    stdout\n    stderr\n    cursor\n  }\n"]);return x=function(){return n},n}function w(){var n=(0,s._)(["\n  query CapturedLogsMetadataQuery($logKey: [String!]!) {\n    capturedLogsMetadata(logKey: $logKey) {\n      stdoutDownloadUrl\n      stdoutLocation\n      stderrDownloadUrl\n      stderrLocation\n    }\n  }\n"]);return w=function(){return n},n}function b(){var n=(0,s._)(["\n  query CapturedLogsQuery($logKey: [String!]!, $cursor: String, $limit: Int) {\n    capturedLogs(logKey: $logKey, cursor: $cursor, limit: $limit) {\n      stdout\n      stderr\n      cursor\n    }\n  }\n"]);return b=function(){return n},n}var C=h.memo(function(n){var e=n.logCaptureInfo,t=(0,i._)(n,["logCaptureInfo"]),o=e&&("stdout"===t.visibleIOType?e.externalStdoutUrl:e.externalStderrUrl);return o?(0,c.jsxs)(f.x,{flex:{direction:"row",alignItems:"center",justifyContent:"center",gap:1},background:p.w.Gray900,style:{color:p.w.White,flex:1,minHeight:0},children:["View logs at",(0,c.jsx)("a",{href:o,target:"_blank",rel:"noreferrer",style:{color:p.w.White,textDecoration:"underline",marginLeft:4,marginRight:4},children:o}),(0,c.jsx)(g.JO,{name:"open_in_new",color:p.w.White,size:20,style:{marginTop:2}})]}):t.logKey.length?(0,c.jsx)(k,(0,r._)({},t)):null}),_=function(n){return n.length<5242880?n:n.slice(-5242880)},S=function(n,e){return e?n?_(n+e):_(e):n||null},j=function(n,e){switch(e.type){case"update":var t,i,u;return(0,o._)((0,r._)({},n),{isLoading:!1,cursor:null===(t=e.logData)||void 0===t?void 0:t.cursor,stdout:S(n.stdout,null===(i=e.logData)||void 0===i?void 0:i.stdout),stderr:S(n.stderr,null===(u=e.logData)||void 0===u?void 0:u.stderr)});case"metadata":return(0,r._)({},n,e.metadata);case"reset":return(0,r._)({},L);default:return n}},L={stdout:null,stderr:null,cursor:null,isLoading:!0},I=h.memo(function(n){var e=n.logKey,t=n.onLogData;return(0,a.m)(R,{fetchPolicy:"no-cache",variables:{logKey:e},onSubscriptionData:function(n){var e,r=n.subscriptionData;(null===(e=r.data)||void 0===e?void 0:e.capturedLogs)&&t(r.data.capturedLogs)}}),null}),R=(0,l.Ps)(x()),E=(0,l.Ps)(w()),N=function(n){var e=n.logKey,t=n.children,r=(0,u._)(h.useReducer(j,L),2),o=r[0],i=r[1],s=JSON.stringify(e);h.useEffect(function(){i({type:"reset"})},[s]);var a=h.useCallback(function(n){i({type:"update",logData:n})},[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I,{logKey:e,onLogData:a}),t(o)]})},T=function(n){var e=n.logKey,t=n.children,r=(0,u._)(h.useReducer(j,L),2),o=r[0],i=r[1],s=JSON.stringify(e);h.useEffect(function(){i({type:"reset"})},[s]);var a=o.cursor,l=(0,d.a)(D,{notifyOnNetworkStatusChange:!0,variables:{logKey:e,cursor:a,limit:1e5},pollInterval:5e3,onCompleted:function(n){f(),i({type:"update",logData:n.capturedLogs}),p(5e3)}}),f=l.stopPolling,p=l.startPolling;return(0,c.jsx)(c.Fragment,{children:t(o)})},D=(0,l.Ps)(b()),k=h.memo(function(n){var e,t,r=n.logKey,o=n.visibleIOType,i=n.onSetDownloadUrl,u=h.useContext(v.I).rootServerURI,s=h.useContext(m.DN),a=s.availability,l=s.disabled,f=(0,d.a)(E,{variables:{logKey:r}});h.useEffect(function(){if(i&&f.data){var n="stdout"===o?f.data.capturedLogsMetadata.stdoutDownloadUrl:f.data.capturedLogsMetadata.stderrDownloadUrl;n&&(n.startsWith("/")?i(u+n):i(n))}},[i,o,u,f.data]);var p=(null===(e=f.data)||void 0===e?void 0:e.capturedLogsMetadata.stdoutLocation)||void 0,g=(null===(t=f.data)||void 0===t?void 0:t.capturedLogsMetadata.stderrLocation)||void 0,x="unavailable"===a||l?T:N;return(0,c.jsx)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:(0,c.jsx)(x,{logKey:r,children:function(n){return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(y.o,{logData:n.stdout,isLoading:n.isLoading,location:p,isVisible:"stdout"===o}),(0,c.jsx)(y.o,{logData:n.stderr,isLoading:n.isLoading,location:g,isVisible:"stderr"===o})]})}})})})},43576:function(n,e,t){t.d(e,{K:function(){return _}});var r=t(52322),o=t(2736),i=t(91588),u=t(2784),s=t(99200),c=t(42130),a=t(85333),l=t(6692),d=t(58467),f=t(73235),p=t(26736),g=t(60138),h=t(7334);function v(){var n=(0,f._)(["\n  subscription ComputeLogsSubscription(\n    $runId: ID!\n    $stepKey: String!\n    $ioType: ComputeIOType!\n    $cursor: String\n  ) {\n    computeLogs(runId: $runId, stepKey: $stepKey, ioType: $ioType, cursor: $cursor) {\n      ...ComputeLogForSubscription\n    }\n  }\n\n  fragment ComputeLogForSubscription on ComputeLogFile {\n    path\n    cursor\n    data\n    downloadUrl\n  }\n"]);return v=function(){return n},n}var m=function(n){return n.length<5242880?n:n.slice(-5242880)},y=function(n,e){if(!e)return n;var t=null==n?void 0:n.data;return(null==n?void 0:n.data)&&(null==e?void 0:e.data)?t=m(n.data+e.data):(null==e?void 0:e.data)&&(t=m(e.data)),{__typename:e.__typename,path:e.path,downloadUrl:e.downloadUrl,data:"string"==typeof t?t:null,cursor:e.cursor}},x=function(n,e){switch(e.type){case"stdout":var t=e.stepKey===n.stepKey?y(n.stdout,e.log):e.log;return(0,l._)((0,a._)({},n),{isLoading:!1,stdout:t});case"stderr":var r=e.stepKey===n.stepKey?y(n.stderr,e.log):e.log;return(0,l._)((0,a._)({},n),{isLoading:!1,stderr:r});default:return n}},w={stepKey:"",stdout:null,stderr:null,isLoading:!0},b=function(n,e){var t=(0,d._)(u.useReducer(x,w),2),r=t[0],o=t[1];return(0,p.m)(C,{fetchPolicy:"no-cache",variables:{runId:n,stepKey:e,ioType:h.E90.STDOUT,cursor:null},onSubscriptionData:function(n){var t;o({type:"stdout",stepKey:e,log:(null===(t=n.subscriptionData.data)||void 0===t?void 0:t.computeLogs)||null})}}),(0,p.m)(C,{fetchPolicy:"no-cache",variables:{runId:n,stepKey:e,ioType:h.E90.STDERR,cursor:null},onSubscriptionData:function(n){var t;o({type:"stderr",stepKey:e,log:(null===(t=n.subscriptionData.data)||void 0===t?void 0:t.computeLogs)||null})}}),r},C=(0,g.Ps)(v()),_=function(n){var e=n.runId,t=n.computeLogFileKey,u=n.ioType,s=n.setComputeLogUrl;return t?(0,r.jsx)(j,{runId:e,computeLogFileKey:t,ioType:u,setComputeLogUrl:s}):(0,r.jsx)(o.x,{flex:{justifyContent:"center",alignItems:"center"},style:{flex:1,height:"100%"},children:(0,r.jsx)(i.$,{purpose:"section"})})},S=function(n,e){return e?e&&e.startsWith("/")?n+e:e:null},j=u.memo(function(n){var e=n.runId,t=n.computeLogFileKey,o=n.ioType,i=n.setComputeLogUrl,c=u.useContext(s.I).rootServerURI,a=b(e,t),l=a.isLoading,d=a.stdout,f=a.stderr,p=S(c,(null==d?void 0:d.downloadUrl)||null),g=S(c,(null==f?void 0:f.downloadUrl)||null);return(0,r.jsxs)("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"},children:[(0,r.jsx)(L,{content:d?d.data:null,path:d?d.path:void 0,downloadUrl:p,isLoading:l,isVisible:"stdout"===o,setComputeLogUrl:i}),(0,r.jsx)(L,{content:f?f.data:null,path:f?f.path:void 0,downloadUrl:g,isLoading:l,isVisible:"stderr"===o,setComputeLogUrl:i})]})}),L=function(n){var e=n.isLoading,t=n.isVisible,o=n.content,i=n.path,s=n.downloadUrl,a=n.setComputeLogUrl;return u.useEffect(function(){a(s)},[a,s]),(0,r.jsx)(c.o,{logData:o,isLoading:e,isVisible:t,downloadUrl:s,location:i})}},13729:function(n,e,t){t.d(e,{C:function(){return T}});var r=t(85333),o=t(6692),i=t(58467),u=t(73235),s=t(82550),c=t(52322),a=t(56675),l=t(26736),d=t(40794),f=t(60138),p=t(12436),g=t.n(p),h=t(2784),v=t(38048),m=t(7334),y=t(54095),x=t(7868);function w(){var n=(0,u._)(["\n  subscription PipelineRunLogsSubscription($runId: ID!, $cursor: String) {\n    pipelineRunLogs(runId: $runId, cursor: $cursor) {\n      ... on PipelineRunLogsSubscriptionFailure {\n        missingRunId\n        message\n      }\n      ...RunLogsSubscriptionSuccess\n    }\n  }\n\n  fragment RunLogsSubscriptionSuccess on PipelineRunLogsSubscriptionSuccess {\n    messages {\n      ... on MessageEvent {\n        runId\n      }\n      ...RunDagsterRunEventFragment\n    }\n    hasMorePastEvents\n    cursor\n  }\n\n  ","\n"]);return w=function(){return n},n}function b(){var n=(0,u._)(["\n  fragment PipelineRunLogsSubscriptionStatusFragment on Run {\n    id\n    status\n    canTerminate\n  }\n"]);return b=function(){return n},n}function C(){var n=(0,u._)(["\n  query RunLogsQuery($runId: ID!, $cursor: String, $limit: Int) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        canTerminate\n      }\n    }\n    logsForRun(runId: $runId, afterCursor: $cursor, limit: $limit) {\n      ... on EventConnection {\n        events {\n          ... on MessageEvent {\n            runId\n          }\n          ...RunDagsterRunEventFragment\n        }\n        cursor\n      }\n      ... on PythonError {\n        message\n        stack\n      }\n    }\n  }\n\n  ","\n"]);return C=function(){return n},n}var _=function(n){var e=(0,s._)(n).reverse(),t=!0,r=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(t=(i=u.next()).done);t=!0)switch(i.value.__typename){case"RunStartEvent":return m.VOA.STARTED;case"RunEnqueuedEvent":return m.VOA.QUEUED;case"RunStartingEvent":return m.VOA.STARTING;case"RunCancelingEvent":return m.VOA.CANCELING;case"RunCanceledEvent":return m.VOA.CANCELED;case"RunSuccessEvent":return m.VOA.SUCCESS;case"RunFailureEvent":return m.VOA.FAILURE}}catch(n){r=!0,o=n}finally{try{t||null==u.return||u.return()}finally{if(r)throw o}}return null},S={DEBUG:0,INFO:0,WARNING:0,ERROR:0,CRITICAL:0,EVENT:0},j=function(n,e){switch(e.type){case"append":var t=e.queued.map(function(n,e){return(0,o._)((0,r._)({},n),{clientsideKey:"csk".concat(n.timestamp,"-").concat(e)})}),i=(0,s._)(n.nodes).concat((0,s._)(t)),u=(0,r._)({},n.counts);return t.forEach(function(n){var e=(0,x.m)(n);u[e]++}),{nodes:i,counts:u,loading:e.hasMore,cursor:e.cursor};case"set-cursor":return(0,o._)((0,r._)({},n),{cursor:e.cursor});case"reset":return{nodes:[],counts:S,cursor:null,loading:!0};default:return n}},L={nodes:[],counts:S,cursor:null,loading:!0},I=function(n){var e=(0,a.x)(),t=h.useRef([]),u=(0,i._)(h.useReducer(j,L),2),l=u[0],d=u[1],f=h.useCallback(function(t){var i=e.readFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:k,id:"Run:".concat(n)});if(i){var u=(0,o._)((0,r._)({},i),{canTerminate:t===m.VOA.QUEUED||t===m.VOA.STARTED,status:t});e.writeFragment({fragmentName:"PipelineRunLogsSubscriptionStatusFragment",fragment:k,id:"Run:".concat(n),data:u})}},[e,n]);h.useEffect(function(){t.current=[],d({type:"reset"})},[n]);var p=h.useMemo(function(){return g()(function(){if(t.current.length){var n=(0,s._)(t.current);t.current=[];var e=n.flatMap(function(n){return n.messages}),r=n[n.length-1],o=r.hasMorePastEvents;d({type:"append",queued:e,hasMore:o,cursor:r.cursor});var i=_(e);i&&!o&&f(i)}},100)},[f]),y=l.nodes,x=l.counts,w=l.cursor,b=l.loading,C=h.useContext(v.DN),S=C.availability,I=C.disabled,E=C.status,N=!I&&"available"===S&&E===WebSocket.CLOSED,T=h.useRef(w);N&&(T.current=w);var D=T.current,K=h.useMemo(function(){return{runId:n,cursor:D}},[n,D]),P=h.useMemo(function(){return(0,c.jsx)(R,{variables:K,onSubscriptionData:function(n){var e,r=null===(e=n.subscriptionData.data)||void 0===e?void 0:e.pipelineRunLogs;r&&"PipelineRunLogsSubscriptionFailure"!==r.__typename&&(t.current.push(r),requestAnimationFrame(p))}})},[K,p]);return h.useMemo(function(){return null!==y?{allNodes:y,counts:x,loading:b,subscriptionComponent:P}:{allNodes:[],counts:x,loading:b,subscriptionComponent:P}},[x,b,y,P])},R=function(n){var e=n.variables,t=n.onSubscriptionData;return(0,l.m)(D,{fetchPolicy:"no-cache",variables:e,onSubscriptionData:t}),null},E=function(n){var e=I(n.runId);return(0,c.jsxs)(c.Fragment,{children:[e.subscriptionComponent,n.children(e)]})},N=function(n){var e=n.children,t=n.runId,r=(0,i._)(h.useReducer(j,L),2),o=r[0],u=r[1],s=o.counts,a=o.cursor,l=o.nodes,f=(0,d.a)(K,{notifyOnNetworkStatusChange:!0,variables:{runId:t,cursor:a,limit:1e4},pollInterval:5e3,onCompleted:function(n){if(p(),(null==n?void 0:n.pipelineRunOrError.__typename)==="Run"&&(null==n?void 0:n.logsForRun.__typename)==="EventConnection"){var e=n.pipelineRunOrError,t=n.logsForRun.events,r=e.status,o=n.logsForRun.cursor,i=!!r&&r!==m.VOA.FAILURE&&r!==m.VOA.SUCCESS&&r!==m.VOA.CANCELED;u({type:"append",queued:t,hasMore:i,cursor:o}),i&&g(5e3)}}}),p=f.stopPolling,g=f.startPolling;return(0,c.jsx)(c.Fragment,{children:e(null!==l&&l.length>0?{allNodes:l,counts:s,loading:!1}:{allNodes:[],counts:s,loading:!0})})},T=function(n){var e=n.children,t=n.runId,r=h.useContext(v.DN),o=r.availability,i=r.disabled;return"unavailable"===o||i?(0,c.jsx)(N,{runId:t,children:e}):"attempting-to-connect"===o?(0,c.jsx)(c.Fragment,{children:e({allNodes:[],counts:S,loading:!0})}):(0,c.jsx)(E,{runId:t,children:e})},D=(0,f.Ps)(w(),y.$K),k=(0,f.Ps)(b()),K=(0,f.Ps)(C(),y.$K)},13304:function(n,e,t){t.d(e,{hi:function(){return o},KZ:function(){return nt}});var r,o,i=t(87612),u=t(85333),s=t(6692),c=t(58467),a=t(73235),l=t(52322),d=t(2736),f=t(61343),p=t(73336),g=t(55829),h=t(70399),v=t(12734),m=t(42971),y=t(91588),x=t(87323),w=t(29403),b=t(2784),C=t(35505),_=t(99339),S=t(51518),j=t(55055),L=t(50027);function I(){var n=(0,a._)(["\n  display: inline-block;\n  width: 11px;\n  height: 11px;\n  border-radius: 5.5px;\n  transition: background 200ms linear;\n  background: ",";\n  &:hover {\n    background: ",";\n  }\n"]);return I=function(){return n},n}var R=C.ZP.div.withConfig({componentId:"sc-82b930f-0"})(I(),function(n){var e,t=n.state;return(e={},(0,i._)(e,L.TN.RUNNING,x.w.Gray400),(0,i._)(e,L.TN.SUCCEEDED,x.w.Green700),(0,i._)(e,L.TN.SKIPPED,x.w.Yellow500),(0,i._)(e,L.TN.FAILED,x.w.Red500),(0,i._)(e,L.TN.PREPARING,x.w.Red500),(0,i._)(e,L.TN.RETRY_REQUESTED,x.w.Red500),(0,i._)(e,L.TN.UNKNOWN,x.w.Red500),e)[t]},function(n){var e,t=n.state;return(e={},(0,i._)(e,L.TN.RUNNING,x.w.Gray400),(0,i._)(e,L.TN.SUCCEEDED,x.w.Green700),(0,i._)(e,L.TN.SKIPPED,x.w.Yellow500),(0,i._)(e,L.TN.FAILED,x.w.Red200),(0,i._)(e,L.TN.PREPARING,x.w.Red500),(0,i._)(e,L.TN.RETRY_REQUESTED,x.w.Red500),(0,i._)(e,L.TN.UNKNOWN,x.w.Red500),e)[t]}),E=t(17577),N=t(13133);function T(){var n=(0,a._)(["\n  justify-content: space-between;\n  width: 100%;\n"]);return T=function(){return n},n}function D(){var n=(0,a._)(["\n  display: flex;\n  flex: 1;\n  align-items: center;\n"]);return D=function(){return n},n}var k=function(n){var e=n.options,t=n.onSetFilter,r=(0,c._)(b.useState(!1),2),o=r[0],i=r[1],u=Object.keys(e),s=Object.values(e).reduce(function(n,e){return e.enabled?n+1:n},0);return(0,l.jsx)(E.J,{isOpen:o,placement:"bottom-start",canEscapeKeyClose:!0,onInteraction:function(n){return i(n)},content:(0,l.jsx)(g.v2,{style:{width:"180px"},"aria-label":"filter-options",children:u.map(function(n){var r=e[n],o=r.label,i=r.count,u=r.enabled;return(0,l.jsx)(g.sN,{tagName:"div",shouldDismissPopover:!1,text:(0,l.jsx)(d.x,{flex:{direction:"row",alignItems:"center"},padding:{horizontal:2},children:(0,l.jsx)(P,{id:"menu-check-".concat(n),checked:u,size:"small",onChange:function(e){t(n,e.target.checked)},label:(0,l.jsxs)(d.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"center"},style:{flex:1},children:[(0,l.jsx)("div",{children:o}),(0,l.jsx)("div",{style:{color:x.w.Gray500},children:(0,N.J)(i)})]})})})},n)})}),children:(0,l.jsxs)(K,{onClick:function(){return i(function(n){return!n})},icon:(0,l.jsx)(v.JO,{name:"filter_alt"}),rightIcon:(0,l.jsx)(v.JO,{name:"expand_more"}),children:["Levels (",s,")"]})})},K=(0,C.ZP)(h.zx).withConfig({componentId:"sc-4ba6164c-0"})(T()),P=(0,C.ZP)(w.X).withConfig({componentId:"sc-4ba6164c-1"})(D()),U=t(37615),O=function(n,e){var t=e.toLocaleLowerCase().trim().split(/\s+/),r=t[t.length-1]||"",o=b.useMemo(function(){return n(r)},[n,r]),i=b.useCallback(function(n){var t=e.toLocaleLowerCase().lastIndexOf(r);if(-1!==t){var o=e.slice(0,t);return"".concat(o).concat(n)}return e},[r,e]);return b.useMemo(function(){return{suggestions:o,onSelectSuggestion:i}},[i,o])},F=t(71539),M=t(71659),$=t(20270);function A(){var n=(0,a._)(["\n  width: 300px;\n"]);return A=function(){return n},n}function V(){var n=(0,a._)(["\n  list-style: none;\n  margin: 0;\n  max-height: 200px;\n  max-width: 800px;\n  min-width: 300px;\n  overflow-y: auto;\n  padding: 4px 0;\n"]);return V=function(){return n},n}function G(){var n=(0,a._)(["\n  align-items: center;\n  background-color: ",";\n  color: ",";\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  font-size: 12px;\n  list-style: none;\n  margin: 0;\n  padding: 4px 8px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n\n  &:hover {\n    background-color: ",";\n  }\n"]);return G=function(){return n},n}var Z=function(n,e){switch(e.type){case"show-popover":return(0,s._)((0,u._)({},n),{shown:!0});case"hide-popover":return(0,s._)((0,u._)({},n),{shown:!1});case"highlight":return(0,s._)((0,u._)({},n),{highlight:e.highlight});case"change-query":return(0,s._)((0,u._)({},n),{shown:!0,highlight:0});case"select-suggestion":return(0,s._)((0,u._)({},n),{highlight:0});default:return n}},q={shown:!1,highlight:0},H={threshold:.3},J=function(n){var e=n.value,t=n.onChange,r=n.suggestionProviders,o=(0,c._)(b.useReducer(Z,q),2),a=o[0],d=o[1],f=a.shown,p=a.highlight,g=b.useRef(null),h=b.useMemo(function(){var n=r.reduce(function(n,e){var t=e.values();return e.token?(0,s._)((0,u._)({},n),(0,i._)({},e.token,{fuse:new M.Z(t,H),all:t})):n},{}),e=r.map(function(n){return n.token}).filter(function(n){return n});return{empty:new M.Z(e,H),perProvider:n}},[r]),m=h.empty,y=h.perProvider,x=O(b.useCallback(function(n){if(!n)return Object.keys(y);var e=(0,c._)(n.split(":"),2),t=e[0],r=e[1];if(t&&t in y){var o=y[t],i=o.fuse,u=o.all,s=r?i.search(r).map(function(n){return"".concat(t,":").concat(n.item)}):u.map(function(n){return"".concat(t,":").concat(n)});return s.map(function(n){return n.toLowerCase()}).includes(n)?[]:s}return m.search(n).map(function(n){return n.item})},[m,y]),e),w=x.suggestions,C=x.onSelectSuggestion,_=w.length,S=w[p]||null,j=b.useCallback(function(n){d({type:"change-query"}),t(n.target.value)},[t]),L=b.useCallback(function(n){d({type:"select-suggestion"}),t(C(n))},[t,C]),I=b.useCallback(function(){var n;d({type:"change-query"}),t(""),null===(n=g.current)||void 0===n||n.focus()},[t]);return(0,l.jsx)(E.J,{isOpen:f&&w.length>0,position:"bottom-left",content:(0,l.jsx)(z,{children:w.map(function(n,e){return(0,l.jsx)(W,{suggestion:n,isHighlight:p===e,onSelect:L},n)})}),children:(0,l.jsx)(Q,{placeholder:"Filter…",spellCheck:!1,autoCorrect:"off",value:e,ref:g,onChange:j,onFocus:function(){return d({type:"show-popover"})},onBlur:function(){return d({type:"hide-popover"})},onKeyDown:function(n){var e=n.key;if("Escape"===e){d({type:"hide-popover"});return}if(_){var t=_-1;switch(e){case"ArrowUp":n.preventDefault(),d({type:"highlight",highlight:0===p?t:p-1});break;case"ArrowDown":n.preventDefault(),d({type:"highlight",highlight:p===t?0:p+1});break;case"Enter":n.preventDefault(),S&&L(S)}}},rightElement:(0,l.jsx)($.C,{onClick:I,children:(0,l.jsx)(v.JO,{name:"cancel"})})})})},W=function(n){var e=n.suggestion,t=n.isHighlight,r=n.onSelect,o=b.useRef(null);return b.useEffect(function(){o.current&&t&&o.current.scrollIntoView({block:"nearest"})},[t]),(0,l.jsx)(B,{ref:o,isHighlight:t,onMouseDown:function(n){n.preventDefault(),r(e)},children:e})},Q=(0,C.ZP)(F.oi).withConfig({componentId:"sc-d9af0d26-0"})(A()),z=C.ZP.ul.withConfig({componentId:"sc-d9af0d26-1"})(V()),B=C.ZP.li.withConfig({componentId:"sc-d9af0d26-2"})(G(),function(n){return n.isHighlight?x.w.Blue500:x.w.White},function(n){return n.isHighlight?x.w.White:"default"},function(n){return n.isHighlight?x.w.Blue500:x.w.Gray100}),Y=t(42016),X=t(52024);function nn(){var n=(0,a._)(["\n  border-radius: 4px;\n  display: block;\n  text-decoration: none;\n\n  "," {\n    transition: background-color 100ms linear;\n  }\n\n  :hover "," {\n    background-color: ",";\n  }\n\n  :active ",", :focus "," {\n    background-color: ",";\n  }\n\n  :focus {\n    outline: none;\n  }\n"]);return nn=function(){return n},n}function ne(){var n=(0,a._)(["\n  &&& {\n    margin: 0 4px 0 12px;\n  }\n\n  white-space: nowrap;\n"]);return ne=function(){return n},n}(r=o||(o={})).structured="structured",r.stdout="stdout",r.stderr="stderr";var nt=function(n){var e=n.steps,t=n.metadata,r=n.counts,i=n.filter,u=n.onSetFilter,s=n.logType,a=n.onSetLogType,p=n.computeLogFileKey,g=n.onSetComputeLogKey,h=n.computeLogUrl,v=n.children,m=(0,c._)((0,j.U)("initial-compute-log-type",function(n){return"string"==typeof n?n:o.stderr}),2),y=m[0],x=m[1],w=b.useCallback(function(n){x(n),a(n)},[a,x]),C=b.useMemo(function(){return new Set([s===o.structured?s:y])},[s,y]);return(0,l.jsxs)(S.qn,{children:[(0,l.jsx)(d.x,{margin:{right:12},children:(0,l.jsx)(f.h,{activeItems:C,buttons:[{id:o.structured,icon:"list",tooltip:"Structured event logs"},{id:y,icon:"wysiwyg",tooltip:"Raw compute logs"}],onClick:function(n){return a(n)}})}),"structured"===s?(0,l.jsx)(nu,{counts:r,filter:i,onSetFilter:u,showCopyURL:!v,steps:e}):(0,l.jsx)(no,{steps:e,metadata:t,logType:s,onSetLogType:w,computeLogFileKey:p,onSetComputeLogKey:g,computeLogUrl:h}),v]})},nr=function(n,e){return e.stepKeys.some(function(e){var t;return(null===(t=n.steps[e])||void 0===t?void 0:t.state)===L.TN.RUNNING})?L.TN.RUNNING:e.stepKeys.some(function(e){var t;return(null===(t=n.steps[e])||void 0===t?void 0:t.state)===L.TN.SKIPPED})?L.TN.SKIPPED:e.stepKeys.every(function(e){var t;return(null===(t=n.steps[e])||void 0===t?void 0:t.state)===L.TN.SUCCEEDED})?L.TN.SUCCEEDED:L.TN.FAILED},no=function(n){var e=n.steps,t=n.metadata,r=n.computeLogFileKey,i=n.onSetComputeLogKey,u=n.logType,s=n.onSetLogType,c=n.computeLogUrl,a=t.logCaptureSteps||(0,L.co)(Object.keys(t.steps)),w=r&&a[r],b=!!w,C=function(n){if(!n||!a[n])return null;var e=a[n];return 1===e.stepKeys.length&&n===e.stepKeys[0]?n:e.pid&&1===e.stepKeys.length?e.stepKeys[0]:e.pid?"pid: ".concat(e.pid," (").concat(e.stepKeys.length," steps)"):"".concat(n," (").concat(e.stepKeys.length," steps)")};return(0,l.jsxs)(d.x,{flex:{justifyContent:"space-between",alignItems:"center",direction:"row"},style:{flex:1},children:[(0,l.jsxs)(d.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[e?(0,l.jsx)(p.P,{disabled:!e.length,items:Object.keys(a),itemPredicate:function(n,e){return e.toLocaleLowerCase().includes(n.toLocaleLowerCase())},itemRenderer:function(n,e){return(0,l.jsx)(g.sN,{onClick:e.handleClick,text:C(n),active:e.modifiers.active},n)},activeItem:r,onItemSelect:function(n){i(n)},children:(0,l.jsx)(h.zx,{disabled:!e.length,rightIcon:(0,l.jsx)(v.JO,{name:"expand_more"}),children:C(r)||"Select a step..."})}):void 0,b?(0,l.jsx)(f.h,{activeItems:new Set([u]),onClick:s,buttons:[{id:o.stdout,label:"stdout"},{id:o.stderr,label:"stderr"}]}):null,e?void 0:(0,l.jsxs)(d.x,{children:["Step: ",((null==w?void 0:w.stepKeys)||[]).join(", ")]})]}),b?(0,l.jsxs)(d.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[w?(0,l.jsx)(m.u,{placement:"top-end",content:"Status of this log capture group",children:nr(t,w)===L.TN.RUNNING?(0,l.jsx)(y.$,{purpose:"body-text"}):(0,l.jsx)(R,{state:nr(t,w)})}):null,c?(0,l.jsx)(m.u,{placement:"top-end",content:(null==w?void 0:w.stepKeys.length)===1?"Download ".concat(null==w?void 0:w.stepKeys[0]," compute logs"):"Download compute logs",children:(0,l.jsx)(ni,{"aria-label":"Download link",href:c,download:!0,children:(0,l.jsx)(v.JO,{name:"download_for_offline",color:x.w.Gray600})})}):null]}):null]})},ni=C.ZP.a.withConfig({componentId:"sc-cc7efc22-0"})(nn(),v.a1,v.a1,x.w.Gray800,v.a1,v.a1,x.w.Dark),nu=function(n){var e,t=n.filter,r=n.counts,o=n.onSetFilter,a=n.steps,f=n.showCopyURL,p=(0,c._)(b.useState("assignment"),2),g=p[0],m=p[1],y=t.logQuery.map(function(n){var e=n.token,t=n.value;return e?"".concat(e,":").concat(t):t}).join(" "),x=(0,c._)(b.useState(function(){return y}),2),w=x[0],C=x[1],L=(0,_.m)(),I=(0,c._)((0,j.U)(X.mF,X.nF),2),R=(I[0],I[1]),E=(null===(e=t.logQuery.find(function(n){return"step"===n.token}))||void 0===e?void 0:e.value)||null,N=t.logQuery.reduce(function(n,e){return n+e.value},"");b.useEffect(function(){C(y)},[y]);var T=b.useCallback(function(n,e){var r=new Set(Object.keys(t.levels).filter(function(n){return!!t.levels[n]}));e?r.add(n):r.delete(n),R(Array.from(r)),o((0,s._)((0,u._)({},t),{levels:(0,s._)((0,u._)({},t.levels),(0,i._)({},n,e))}))},[t,o,R]);b.useEffect(function(){var n;return"assignment_turned_in"===g&&(n=setTimeout(function(){m("assignment")},2e3)),function(){n&&clearTimeout(n)}},[g]);var D=Object.fromEntries(Object.keys(U.i).map(function(n){return[n,{label:n.toLowerCase(),count:r[n],enabled:!!t.levels[n]}]}));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(J,{value:w,suggestionProviders:(0,Y.m)(a),onChange:function(n){var e=n.split(/\s+/).map(function(n){var e=n.split(":");return e.length>1?{token:e[0],value:e[1]}:{value:e[0]}});o((0,s._)((0,u._)({},t),{logQuery:e})),C(n)}}),N?(0,l.jsx)(ns,{checked:t.hideNonMatches,onChange:function(n){return o((0,s._)((0,u._)({},t),{hideNonMatches:n.currentTarget.checked}))},label:"Hide non-matches"}):null,(0,l.jsx)(d.x,{flex:{direction:"row",alignItems:"center",gap:8},margin:{left:12},children:(0,l.jsx)(k,{options:D,onSetFilter:T})}),E&&(0,l.jsx)(S.KC,{}),(0,l.jsx)("div",{style:{minWidth:15,flex:1}}),f&&(0,l.jsx)(h.zx,{icon:(0,l.jsx)(v.JO,{name:g}),onClick:function(){L(window.location.href),m("assignment_turned_in")},children:"Copy URL"})]})},ns=(0,C.ZP)(w.X).withConfig({componentId:"sc-cc7efc22-1"})(ne())},42130:function(n,e,t){t.d(e,{o:function(){return T}});var r=t(47803),o=t(49346),i=t(58467),u=t(73235),s=t(48794),c=t(52322),a=t(92914),l=t(12734),d=t(87323),f=t(91588),p=t(94901),g=t(44826),h=t.n(g),v=t(2784),m=t(35505);function y(){var n=(0,u._)(["\n  padding: 10px;\n  background-color: ",";\n"]);return y=function(){return n},n}function x(){var n=(0,u._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  border-right: 1px solid #5c7080;\n  padding: 10px 10px 10px 20px;\n  margin-right: 5px;\n  background-color: ",";\n  opacity: 0.8;\n  color: #858585;\n  min-height: 100%;\n"]);return x=function(){return n},n}function w(){var n=(0,u._)(["\n  .ansi-black {\n    color: #586e75;\n  }\n  .ansi-red {\n    color: #dc322f;\n  }\n  .ansi-green {\n    color: #859900;\n  }\n  .ansi-yellow {\n    color: #b58900;\n  }\n  .ansi-blue {\n    color: #268bd2;\n  }\n  .ansi-magenta {\n    color: #d33682;\n  }\n  .ansi-cyan {\n    color: #2aa198;\n  }\n  .ansi-white {\n    color: #eee8d5;\n  }\n"]);return w=function(){return n},n}function b(){var n=(0,u._)(["\n  display: flex;\n  flex-direction: row;\n  min-height: 100%;\n  background-color: ",";\n"]);return b=function(){return n},n}function C(){var n=(0,u._)(["\n  flex: 1;\n  height: 100%;\n  position: relative;\n  &:first-child {\n    border-right: 0.5px solid #5c7080;\n  }\n  display: flex;\n  flex-direction: column;\n  ","\n"]);return C=function(){return n},n}function _(){var n=(0,u._)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 30px;\n  background-color: ",";\n  border-top: 0.5px solid #5c7080;\n  color: #aaaaaa;\n  padding: 2px 5px;\n  font-size: 0.85em;\n  ","\n"]);return _=function(){return n},n}function S(){var n=(0,u._)(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n"]);return S=function(){return n},n}function j(){var n=(0,u._)(["\n  flex: 1;\n  position: relative;\n"]);return j=function(){return n},n}function L(){var n=(0,u._)(["\n  color: #eeeeee;\n  font-family: ",";\n  font-size: 16px;\n  white-space: pre;\n  overflow: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n"]);return L=function(){return n},n}function I(){var n=(0,u._)(["\n  display: flex;\n  justifycontent: center;\n  alignitems: center;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  backgroundcolor: ",";\n  opacity: 0.3;\n"]);return I=function(){return n},n}function R(){var n=(0,u._)(["\n  position: absolute;\n  height: 30px;\n  top: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: flex-start;\n  z-index: 1;\n"]);return R=function(){return n},n}function E(){var n=(0,u._)(["\n  background-color: black;\n  padding: 10px 20px;\n  border-bottom-right-radius: 5px;\n  border-bottom-left-radius: 5px;\n  color: white;\n  border-bottom: 0.5px solid #5c7080;\n  border-left: 0.5px solid #5c7080;\n  border-right: 0.5px solid #5c7080;\n  cursor: pointer;\n"]);return E=function(){return n},n}function N(){var n=(0,u._)(["\n  background-color: #fffae3;\n  padding: 10px 20px;\n  margin: 20px 70px;\n  border-radius: 5px;\n"]);return N=function(){return n},n}var T=v.memo(function(n){var e=n.logData,t=n.location,r=n.isLoading,o=n.isVisible,u=n.downloadUrl,s=v.useRef(null),p=v.useRef(),g=(0,i._)(v.useState(!1),2),h=g[0],m=g[1],y=function(){p.current&&(clearTimeout(p.current),p.current=0)},x=function(){m(!1),y()},w=function(){p.current=window.setTimeout(x,3e3)},b=e,C=D(b);if(b&&C){var _=b.indexOf("\n")+1;b="\x1b[33m...logs truncated...\x1b[39m\n"+(_<b.length?b.slice(_):b)}var S=C?(0,c.jsx)(J,{children:(0,c.jsxs)(a.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,c.jsx)(l.JO,{name:"warning",color:d.w.Yellow500}),(0,c.jsxs)("div",{children:["This log has exceeded the 5MB limit."," ",u?(0,c.jsx)("a",{href:u,download:!0,children:"Download the full log file"}):null,"."]})]})}):null;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(M,{isVisible:o,children:[h?(0,c.jsx)(q,{children:(0,c.jsx)(H,{onClick:function(){s.current&&s.current.scrollToTop()},onMouseOver:y,onMouseOut:w,children:(0,c.jsxs)(a.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,c.jsx)(l.JO,{name:"arrow_upward",color:d.w.White}),"Scroll to top"]})})}):null,(0,c.jsxs)(A,{children:[S,(0,c.jsx)(V,{children:(0,c.jsx)(G,{isSelected:!0,content:e,onScrollUp:function(n){y(),n?(m(!0),w()):x()},onScrollDown:x,ref:s})})]}),r?(0,c.jsx)(Z,{children:(0,c.jsx)(f.$,{purpose:"page"})}):null]}),t?(0,c.jsx)($,{isVisible:o,children:t}):null]})}),D=function(n){return!!n&&new TextEncoder().encode(n).length>=5242880},k=function(n){(0,o._)(t,n);var e=(0,s._)(t);function t(){var n;return(0,r._)(this,t),n=e.apply(this,arguments),n.container=v.createRef(),n.lastScroll=0,n.onScroll=function(){if(n.container.current&&n.props.isSelected){var e=n.props,t=e.onScrollUp,r=e.onScrollDown,o=n.container.current,i=o.scrollHeight,u=o.scrollTop/(i-o.offsetHeight);n.container.current.scrollTop<n.lastScroll?t&&t(u):r&&r(u),n.lastScroll=n.container.current.scrollTop}},n}var i=t.prototype;return i.componentDidMount=function(){this.scrollToBottom(),this.container.current&&(this.container.current.focus(),this.container.current.addEventListener("scroll",this.onScroll))},i.getSnapshotBeforeUpdate=function(){if(!this.container.current)return!1;var n=this.container.current,e=n.scrollHeight,t=n.scrollTop;return n.offsetHeight+t>=e},i.componentDidUpdate=function(n,e,t){t&&this.scrollToBottom(),this.props.isSelected&&!n.isSelected&&this.container.current&&this.container.current.focus()},i.focus=function(){var n=this.container.current;n&&n.focus()},i.scrollToBottom=function(){var n=this.container.current;n&&(n.scrollTop=n.scrollHeight-n.offsetHeight)},i.scrollToTop=function(){var n=this.container.current;n&&(n.scrollTop=0,n.focus())},i.render=function(){var n=this.props,e=n.content,t=n.className;return e?(0,c.jsx)("div",{className:t,style:{outline:"none"},ref:this.container,tabIndex:0,children:(0,c.jsxs)(F,{children:[(0,c.jsx)(K,{content:e}),(0,c.jsxs)(P,{children:[(0,c.jsx)(O,{}),(0,c.jsx)(h(),{linkify:!1,useClasses:!0,children:e})]})]})}):(0,c.jsx)("div",{className:t,ref:this.container,children:(0,c.jsx)(F,{style:{justifyContent:"center",alignItems:"center"},children:null==e?"No log file available":"No output"})})},t}(v.Component),K=function(n){var e=n.content;if(!e)return null;var t=e.match(/\n/g),r=t?t.length:0;return(0,c.jsx)(U,{children:Array.from(Array(r),function(n,e){return(0,c.jsx)("div",{children:String(e+1)},e)})})},P=m.ZP.div.withConfig({componentId:"sc-4f837f80-0"})(y(),d.w.Gray900),U=m.ZP.div.withConfig({componentId:"sc-4f837f80-1"})(x(),d.w.Gray900),O=(0,m.vJ)(w()),F=m.ZP.div.withConfig({componentId:"sc-4f837f80-2"})(b(),d.w.Gray900),M=m.ZP.div.withConfig({componentId:"sc-4f837f80-3"})(C(),function(n){return n.isVisible?null:"display: none;"}),$=m.ZP.div.withConfig({componentId:"sc-4f837f80-4"})(_(),d.w.Gray900,function(n){return n.isVisible?null:"display: none;"}),A=m.ZP.div.withConfig({componentId:"sc-4f837f80-5"})(S()),V=m.ZP.div.withConfig({componentId:"sc-4f837f80-6"})(j()),G=(0,m.ZP)(k).withConfig({componentId:"sc-4f837f80-7"})(L(),p.b.monospace),Z=m.ZP.div.withConfig({componentId:"sc-4f837f80-8"})(I(),d.w.Gray800),q=m.ZP.div.withConfig({componentId:"sc-4f837f80-9"})(R()),H=m.ZP.div.withConfig({componentId:"sc-4f837f80-10"})(E()),J=m.ZP.div.withConfig({componentId:"sc-4f837f80-11"})(N())},29330:function(n,e,t){t.d(e,{c:function(){return u},r:function(){return s}});var r=t(58467),o=t(2784),i=t(76358),u=function(n,e){var t=(n?Object.values(n):[]).find(function(n){return n.stepKeys.includes(e)});return t&&(null==t?void 0:t.fileKey)};function s(n){var e=n.stepKeys,t=n.selectionStepKeys,s=n.metadata,c=(0,r._)((0,i.q)({queryKey:"logFileKey"}),2),a=c[0],l=c[1];return o.useEffect(function(){if((null==e?void 0:e.length)&&!a){if(s.logCaptureSteps){var n=Object.keys(s.logCaptureSteps);l(n.find(function(n){return t.every(function(e){return s.logCaptureSteps&&s.logCaptureSteps[n].stepKeys.includes(e)})})||n[0])}else if(e.includes(a)){if(1===t.length&&a!==t[0]){var r=u(s.logCaptureSteps,t[0]);r&&l(r)}}else{var o=u(s.logCaptureSteps,1===t.length?t[0]:e[0]);o&&l(o)}}},[e,a,t,s.logCaptureSteps,l]),{logCaptureInfo:s.logCaptureSteps&&a in s.logCaptureSteps?s.logCaptureSteps[a]:void 0,computeLogFileKey:a,setComputeLogFileKey:l}}},52024:function(n,e,t){t.d(e,{Bz:function(){return x},mF:function(){return m},nF:function(){return y}});var r=t(87612),o=t(85333),i=t(6692),u=t(58467),s=t(28413),c=t(2784),a=t(76358),l=t(55055),d=t(37615),f=t(42016);function p(n){return n.sort().map(function(n){return n.toLowerCase()}).join("|")}var g={steps:"*",logs:"",levels:p(d.w),hideNonMatches:"true",focusedTime:""},h=function(n){var e=n.logs||"",t=n.focusedTime||"",u=n.hideNonMatches||"",c=n.levels||"",a=e.split("|"),l=t&&!e?Number(t):null,p=(0,f.m)();return{sinceTime:0,focusedTime:l,hideNonMatches:"true"===u,logQuery:a.map(function(n){return(0,s.WD)(n,p)}),levels:c.split("|").map(function(n){return n.toUpperCase()}).filter(function(n){return d.i.hasOwnProperty(n)}).reduce(function(n,e){return(0,i._)((0,o._)({},n),(0,r._)({},e,!0))},{})}};function v(n){var e=n.logQuery.map(function(n){return n.token?"".concat(n.token,":").concat(n.value):n.value});return{hideNonMatches:n.hideNonMatches?"true":"false",focusedTime:n.focusedTime||"",logs:e.join("|"),levels:p(Object.keys(n.levels).filter(function(e){return!!n.levels[e]}))}}var m="EnabledRunLogLevels",y=function(n){if(void 0===n||!Array.isArray(n))return null;var e=new Set(Object.keys(d.i));return n.filter(function(n){return e.has(n)})};function x(){var n=(0,u._)((0,l.U)(m,y),1)[0],e=c.useMemo(function(){var e=null!=n?n:d.w;return(0,i._)((0,o._)({},g),{levels:p(e)})},[n]);return(0,a.q)({encode:v,decode:h,defaults:e})}}}]);
//# sourceMappingURL=298.894c8ec53cc5a5cb.js.map