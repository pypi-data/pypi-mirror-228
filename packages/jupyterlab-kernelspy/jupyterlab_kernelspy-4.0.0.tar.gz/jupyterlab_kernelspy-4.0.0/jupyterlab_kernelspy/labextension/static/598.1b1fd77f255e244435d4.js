"use strict";(self.webpackChunkjupyterlab_kernelspy=self.webpackChunkjupyterlab_kernelspy||[]).push([[598],{598:(e,t,n)=>{n.r(t),n.d(t,{IKernelSpyExtension:()=>M,KernelSpyExtension:()=>W,default:()=>F});var o=n(965),r=n(609),s=n(450),a=n(212),l=n(697),i=n(930),d=n(717),c=n(4),p=n(29),h=n(888),u=n(778),m=n(418);class g{constructor(e,t){this._threads=e,this._collapsed=t,this._index=-1,this._child=null}iter(){return this}[Symbol.iterator](){return{next:()=>{if(this._child){const e=this._child.next();if(void 0!==e)return{value:e,done:!1};this._child=null}if(++this._index,this._index>=this._threads.length)return{done:!0};const e=this._threads[this._index];return e.children.length>0&&!this._collapsed[e.args.msg.header.msg_id]&&(this._child=new g(e.children,this._collapsed)),{value:{args:e.args,hasChildren:e.children.length>0},done:!1}}}}next(){if(this._child){const e=this._child.next();if(void 0!==e)return e;this._child=null}if(++this._index,this._index>=this._threads.length)return;const e=this._threads[this._index];return e.children.length>0&&!this._collapsed[e.args.msg.header.msg_id]&&(this._child=new g(e.children,this._collapsed)),{args:e.args,hasChildren:e.children.length>0}}clone(){const e=new g(this._threads,this._collapsed);return e._index=this._index,this._child&&(e._child=this._child.clone()),e}}class _ extends r.VDomModel{constructor(e){super(),this._log=[],this._kernel=null,this._messages={},this._childLUT={},this._roots=[],this.kernel=null!=e?e:null}clear(){this._log.splice(0,this._log.length),this._messages={},this._childLUT={},this._roots=[],this.stateChanged.emit(void 0)}get kernel(){return this._kernel}set kernel(e){this._kernel&&this._kernel.anyMessage.disconnect(this.onMessage,this),this._kernel=e,this._kernel&&this._kernel.anyMessage.connect(this.onMessage,this)}get log(){return this._log}get tree(){return this._roots.map((e=>this.getThread(e,!1)))}depth(e){if(null===e)return-1;let t=0;for(;e=this._findParent(e);)++t;return t}getThread(e,t=!0){const n=this._messages[e];if(t){let e,t=n;for(;e=this._findParent(t);)t=e;return this.getThread(t.msg.header.msg_id,!1)}const o=(this._childLUT[e]||[]).map((e=>this.getThread(e,!1)));return{args:this._messages[e],children:o}}onMessage(e,t){const{msg:n}=t;this._log.push(t),this._messages[n.header.msg_id]=t;const o=this._findParent(t);if(null===o)this._roots.push(n.header.msg_id);else{const e=o.msg.header;this._childLUT[e.msg_id]=this._childLUT[e.msg_id]||[],this._childLUT[e.msg_id].push(n.header.msg_id)}this.stateChanged.emit(void 0)}_findParent(e){return void 0!==e.msg.parent_header.msg_id&&this._messages[e.msg.parent_header.msg_id]||null}}var v=n(379),f=n.n(v),y=n(795),b=n.n(y),k=n(569),j=n.n(k),C=n(565),E=n.n(C),x=n(216),w=n.n(x),O=n(589),T=n.n(O),N=n(760),A={};A.styleTagTransform=T(),A.setAttributes=E(),A.insert=j().bind(null,"head"),A.domAPI=b(),A.insertStyleElement=w(),f()(N.Z,A),N.Z&&N.Z.locals&&N.Z.locals;const I={BASE_FONT_FAMILY:"var(--jp-code-font-family)",BASE_FONT_SIZE:"var(--jp-code-font-size)",BASE_LINE_HEIGHT:"var(--jp-code-line-height)",BASE_BACKGROUND_COLOR:"var(--jp-layout-color0)",BASE_COLOR:"var(--jp-content-font-color1)",OBJECT_NAME_COLOR:"var(--jp-mirror-editor-attribute-color)",OBJECT_VALUE_NULL_COLOR:"var(--jp-mirror-editor-builtin-color)",OBJECT_VALUE_UNDEFINED_COLOR:"var(--jp-mirror-editor-builtin-color)",OBJECT_VALUE_REGEXP_COLOR:"var(--jp-mirror-editor-string-color)",OBJECT_VALUE_STRING_COLOR:"var(--jp-mirror-editor-string-color)",OBJECT_VALUE_SYMBOL_COLOR:"var(--jp-mirror-editor-operator-color)",OBJECT_VALUE_NUMBER_COLOR:"var(--jp-mirror-editor-number-color)",OBJECT_VALUE_BOOLEAN_COLOR:"var(--jp-mirror-editor-builtin-color))",OBJECT_VALUE_FUNCTION_KEYWORD_COLOR:"var(--jp-mirror-editor-def-color))",ARROW_COLOR:"var(--jp-content-font-color2)",ARROW_MARGIN_RIGHT:3,ARROW_FONT_SIZE:12,TREENODE_FONT_FAMILY:"var(--jp-code-font-family)",TREENODE_FONT_SIZE:"var(--jp-code-font-size)",TREENODE_LINE_HEIGHT:"var(--jp-code-line-height)",TREENODE_PADDING_LEFT:12};function L(e){const{name:t,depth:n,isNonenumerable:o,data:r}=e;if(0!==n)return p.createElement(m.ObjectLabel,{key:"node-label",name:t,data:r,isNonenumerable:o});const s=r;return p.createElement("span",{key:"node-label"},s.header.msg_id)}function R(e){const t=e.message,n=t.header.msg_id,o=e.collapsed?"jp-mod-collapsed":"",r=e.hasChildren?e.collapsed?h.caretRightIcon:h.caretDownIcon:null,s=e.hasChildren?"jp-mod-children":"",a=e.hasChildren?0:-1;return[p.createElement("div",{key:`threadnode-${n}`,className:"jp-kernelspy-threadnode",onClick:()=>{e.onCollapse(e.message)}},p.createElement("div",{style:{paddingLeft:16*e.depth}},p.createElement("button",{className:`jp-kernelspy-threadcollapser ${o} ${s}`,tabIndex:a},r&&p.createElement(r.react,{className:"kspy-collapser-icon"})),p.createElement("span",{className:"jp-kernelspy-threadlabel"},t.channel,".",t.header.msg_type))),p.createElement("div",{key:`message-${n}`,className:"jp-kernelspy-message"},p.createElement(m.ObjectInspector,{data:t,theme:I,nodeRenderer:L}))]}class B extends r.VDomRenderer{constructor(e){super(e),this.collapsed={},this.id=`kernelspy-messagelog-${i.UUID.uuid4()}`,this.addClass("jp-kernelspy-messagelog")}render(){const e=this.model,t=[];t.push(p.createElement("span",{key:"header-thread",className:"jp-kernelspy-logheader"},"Threads"),p.createElement("span",{key:"header-contents",className:"jp-kernelspy-logheader"},"Contents"),p.createElement("span",{key:"header-divider",className:"jp-kernelspy-logheader jp-kernelspy-divider"}));const n=new g(e.tree,this.collapsed);let o=!0;for(const r of n)if(r){const n=e.depth(r.args);0===n&&(o?o=!1:t.push(p.createElement("span",{key:`'divider-${r.args.msg.header.msg_id}`,className:"jp-kernelspy-divider"})));const s=this.collapsed[r.args.msg.header.msg_id];t.push(...R({message:r.args.msg,depth:n,collapsed:s,hasChildren:r.hasChildren,onCollapse:e=>{this.onCollapse(e)}}))}return t}collapseAll(){for(const e of this.model.log)this.collapsed[e.msg.header.msg_id]=!0;this.update()}expandAll(){this.collapsed={},this.update()}onCollapse(e){const t=e.header.msg_id;this.collapsed[t]=!this.collapsed[t],this.update()}}class S extends u.Widget{constructor(e){super(),this._model=new _(e),this.addClass("jp-kernelspy-view"),this.id=`kernelspy-${i.UUID.uuid4()}`,this.title.label="Kernel spy",this.title.closable=!0,this.title.icon=h.jsonIcon;const t=this.layout=new u.BoxLayout;this._toolbar=new r.Toolbar,this._toolbar.addClass("jp-kernelspy-toolbar"),this._messagelog=new B(this._model),t.addWidget(this._toolbar),t.addWidget(this._messagelog),u.BoxLayout.setStretch(this._toolbar,0),u.BoxLayout.setStretch(this._messagelog,1),this.collapseAllButton=new r.ToolbarButton({onClick:()=>{this._messagelog.collapseAll()},className:"jp-kernelspy-collapseAll",icon:h.caretRightIcon,tooltip:"Collapse all threads"}),this._toolbar.addItem("collapse-all",this.collapseAllButton),this.expandAllButton=new r.ToolbarButton({onClick:()=>{this._messagelog.expandAll()},className:"jp-kernelspy-expandAll",icon:h.caretDownIcon,tooltip:"Expand all threads"}),this._toolbar.addItem("expand-all",this.expandAllButton),this.clearAllButton=new r.ToolbarButton({onClick:()=>{this._model.clear()},className:"jp-kernelspy-clearAll",icon:h.closeIcon,tooltip:"Clear all threads"}),this._toolbar.addItem("clear-all",this.clearAllButton)}onActivateRequest(e){this.node.contains(document.activeElement)||this.collapseAllButton.node.focus()}get model(){return this._model}}var U;!function(e){e.newSpy="kernelspy:new"}(U||(U={}));const M=new i.Token("jupyter.extensions.kernelspy"),D=new c.AttachedProperty({create:()=>"",name:"SpyTarget"});class W{constructor(e){this.commands=e}createNew(e,t){const n=[];let o=-1;(0,l.find)(e.toolbar.children(),((e,t)=>!!e.hasClass("jp-Notebook-toolbarCellType")&&(o=t,!0)));let s=1;for(const t of[U.newSpy]){const a=new r.CommandToolbarButton({id:t,commands:this.commands});a.addClass("jp-kernelspy-nbtoolbarbutton"),o>=0?e.toolbar.insertItem(o+s++,this.commands.label(t),a):e.toolbar.addItem(this.commands.label(t),a),n.push(a)}return new d.DisposableDelegate((()=>{for(const e of n)e.dispose()}))}}const F={id:"jupyterlab-kernelspy",autoStart:!0,requires:[a.INotebookTracker],optional:[r.ICommandPalette,s.IMainMenu,o.ILayoutRestorer],provides:M,activate:async(e,t,n,o,s)=>{const{commands:a,docRegistry:l}=e,i=new W(a);l.addWidgetExtension("Notebook",i);const d=new r.WidgetTracker({namespace:"kernelspy"});function c(){a.notifyCommandChanged(U.newSpy)}s&&s.restore(d,{command:U.newSpy,args:e=>({path:D.get(e.content),activate:!1}),name:e=>D.get(e.content),when:t.restored}),function(e,t,n,o,s){const{commands:a,shell:l}=e;a.addCommand(U.newSpy,{label:"New kernel spy",caption:"Open a window to inspect messages sent to/from a kernel",iconClass:"jp-Icon jp-Icon-16 jp-kernelspy-icon",isEnabled:function(){var e,n,o;return null!==t.currentWidget&&null!==(null!==(o=null===(n=null===(e=t.currentWidget.context.sessionContext)||void 0===e?void 0:e.session)||void 0===n?void 0:n.kernel)&&void 0!==o?o:null)},execute:e=>{var o,s,a;let i;if(i=e.path?null!==(o=t.find((t=>t.context.path===e.path)))&&void 0!==o?o:null:t.currentWidget,!i)return;const d=new S(null===(a=null===(s=i.context.sessionContext)||void 0===s?void 0:s.session)||void 0===a?void 0:a.kernel);d.title.label=`Kernel spy: ${i.title.label}`,i.title.changed.connect((()=>{d.title.label=`Kernel spy: ${i.title.label}`}));const c=new r.MainAreaWidget({content:d});D.set(d,i.context.path),i.context.pathChanged.connect(((e,t)=>{D.set(d,t),n.save(c)})),n.add(c),i.context.sessionContext.kernelChanged.connect(((e,t)=>{d.model.kernel=t.newValue})),l.add(c,"main",{mode:"split-right"}),!1!==e.activate&&l.activateById(c.id),i.disposed.connect((()=>{c.close()}))}}),null==o||o.addItem({command:U.newSpy,category:"Kernel"}),null==s||s.kernelMenu.addGroup([{command:U.newSpy}])}(e,t,d,n,o),t.currentChanged.connect(c);let p=t.currentWidget;return p&&p.context.sessionContext.kernelChanged.connect(c),t.currentChanged.connect((e=>{p&&p.context.sessionContext.kernelChanged.disconnect(c),p=e.currentWidget,p&&p.context.sessionContext.kernelChanged.connect(c)})),i}}},150:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(81),r=n.n(o),s=n(645),a=n.n(s)()(r());a.push([e.id,".jp-kernelspy-view .jp-kernelspy-toolbar {\n  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);\n  padding: 2px;\n  min-height: var(--jp-private-notebook-panel-toolbar-height);\n  box-shadow: var(--jp-toolbar-box-shadow);\n  background: var(--jp-toolbar-background);\n  z-index: 1;\n}\n\n.jp-kernelspy-view .jp-kernelspy-messagelog {\n  padding: 8px;\n  overflow: auto;\n  white-space: nowrap;\n  font-family: var(--jp-code-font-family);\n  font-size: var(--jp-code-font-size);\n  line-height: var(--jp-code-line-height);\n  color: var(--jp-content-font-color1);\n  background-color: var(--jp-layout-color0);\n  display: grid;\n  grid-template-columns: max-content auto;\n  grid-gap: 2px 12px;\n  align-content: start;\n}\n\n.jp-kernelspy-view .jp-kernelspy-logheader {\n  font-family: var(--jp-ui-font-family);\n  font-size: var(--jp-ui-font-size1);\n  line-height: 1;\n}\n\n.jp-kernelspy-view .jp-kernelspy-divider {\n  grid-column-end: span 2;\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);\n  padding-top: 2px;\n  margin-bottom: 3px;\n}\n\n.jp-kernelspy-view .jp-kernelspy-divider.jp-kernelspy-logheader {\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color0);\n}\n\nbutton.jp-kernelspy-threadcollapser {\n  background-color: transparent;\n  border: none;\n}\n\n.jp-kernelspy-icon {\n  background-image: var(--jp-icon-json);\n}\n\n.jp-kernelspy-nbtoolbarbutton .jp-ToolbarButtonComponent-label {\n  display: none;\n}\n\n.kspy-collapser-icon {\n  padding: 0;\n}\n\n.kspy-collapser-icon svg {\n  vertical-align: middle;\n}\n",""]);const l=a},760:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(81),r=n.n(o),s=n(645),a=n.n(s),l=n(150),i=a()(r());i.i(l.Z),i.push([e.id,"\n",""]);const d=i},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var l=0;l<this.length;l++){var i=this[l][0];null!=i&&(a[i]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);o&&a[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),t.push(c))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var s={},a=[],l=0;l<e.length;l++){var i=e[l],d=o.base?i[0]+o.base:i[0],c=s[d]||0,p="".concat(d," ").concat(c);s[d]=c+1;var h=n(p),u={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};if(-1!==h)t[h].references++,t[h].updater(u);else{var m=r(u,o);o.byIndex=l,t.splice(l,0,{identifier:p,updater:m,references:1})}a.push(p)}return a}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=o(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var l=n(s[a]);t[l].references--}for(var i=o(e,r),d=0;d<s.length;d++){var c=n(s[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}s=i}}},569:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}}]);